<div class="container py-4" *ngIf="ad">
  <div class="row">
    <!-- Leva strana - detalji oglasa -->
    <div class="col-md-8">
      <div class="card mb-3">
        <div class="ad-images" *ngIf="ad.urlPhotos?.length">
          <img *ngFor="let photo of ad.urlPhotos" [src]="photo" class="img-fluid mb-2" />
        </div>

        <div class="card-body">
          <h3>{{ ad.title }}</h3>
          <p class="text-muted">{{ ad.city }}, {{ ad.country }} • {{ ad.address }}</p>
          <p>{{ ad.description }}</p>

          <div>
            <small>Sobe: {{ ad.numberOfRooms }} • Površina: {{ ad.homeArea }} m²</small>
            <br />
            <small> Dvorište: {{ ad.garden ? 'Da' : 'Ne' }} </small>
            <br />
            <small> Parking: {{ ad.parkingSpace ? 'Da' : 'Ne' }} </small>
            <br />
            <small> Bazen: {{ ad.swimmingPool ? 'Da' : 'Ne' }} </small>
            <br />
            <small> Datum objavljivanja: {{ ad.date }}</small>
          </div>

          <div class="mt-3">
            <button type="button" class="btn btn-warning me-2" (click)="editAd(ad)">Izmeni</button>
            <button type="button" class="btn btn-danger" (click)="deleteAd(ad.id)">Obriši</button>
          </div>
          <div *ngIf="isEditing" class="card p-3 mb-3">
            <h5>Izmena oglasa</h5>
            <textarea [(ngModel)]="editForm.description" class="form-control mb-2"></textarea>

            <label> <input type="checkbox" [(ngModel)]="editForm.garden" /> Dvorište </label>
            <br />
            <label> <input type="checkbox" [(ngModel)]="editForm.parkingSpace" /> Parking </label>
            <br />
            <label> <input type="checkbox" [(ngModel)]="editForm.swimmingPool" /> Bazen </label>
            <br />
            <button type="button" class="btn btn-success mt-2" (click)="saveEdit(ad)">
              Sačuvaj
            </button>
            <button type="button" class="btn btn-secondary mt-2" (click)="isEditing = false">
              Otkaži
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Desna strana - rezervacije i ocene -->
    <div class="col-md-4">
      <!-- Rezervacije -->
      <div class="card p-3 mb-3">
        <h5>Rezervacije</h5>
        <div *ngIf="reservations.length > 0; else noReservations">
          <div *ngFor="let res of reservations" class="border p-2 mb-2 rounded">
            <p>
              Od {{ res.startDate | date : 'dd.MM.yyyy' }} do
              {{ res.endDate | date : 'dd.MM.yyyy' }}
            </p>
            <small> Potvrdjeno: {{ res.isExchangeConfirmed ? 'Da' : 'Ne' }} </small>
            <br />
            <small>
              Korisnik: {{ res.userFirstName }} {{ res.userLastName }} ({{ res.userEmail }})
            </small>
          </div>
        </div>
        <ng-template #noReservations>
          <p>Još nema rezervacija za ovaj oglas.</p>
        </ng-template>
      </div>

      <!-- Ocene -->
      <div class="card p-3">
        <h5>Recenzije</h5>
        <div *ngIf="ratings.length > 0; else noRatings">
          <div *ngFor="let r of ratings" class="border p-2 mb-2 rounded">
            <small> {{ r.userFirstName }} {{ r.userLastName }} </small>
            <p>
              <strong>{{ r.score }} / 5</strong>
            </p>
            <p>{{ r.comment }}</p>
          </div>
        </div>
        <ng-template #noRatings>
          <p>Još nema recenzija za ovaj oglas.</p>
        </ng-template>
      </div>
    </div>
  </div>
</div>
