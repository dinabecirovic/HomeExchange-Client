<div class="container py-4" *ngIf="ad">
  <div class="row">
    <!-- Left column -->
    <div class="col-md-8">
      <div class="card mb-3">
        <!--img *ngIf="ad.urlPhotos?.length" [src]="ad.urlPhotos[0]" class="card-img-top ad-image" /-->
        <div class="ad-images" *ngIf="ad.urlPhotos?.length">
          <img *ngFor="let photo of ad.urlPhotos" [src]="photo" class="img-fluid mb-2" />
        </div>

        <div class="card-body">
          <h3>{{ ad.title }}</h3>
          <p class="text-muted">{{ ad.city }}, {{ ad.country }} • {{ ad.address }}</p>
          <p>{{ ad.description }}</p>
          <div>
            <small>Sobe: {{ ad.numberOfRooms }} • Površina: {{ ad.homeArea }}</small>
            <br />
            <small
              >Dvorište: {{ ad.garden }} • Parking mesto: {{ ad.parkingSpace }} • Bazen:
              {{ ad.swimmingPool }}
            </small>
            <br />
            <small> Datum objavljivanja: {{ ad.date }}</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Right column -->
    <div *ngIf="currentUser?.id !== ad.homeOwnerId">
      <div class="col-md-4">
        <!-- Reservation status -->
        <div
          *ngIf="reservationStatus"
          class="alert mt-2"
          [ngClass]="reservationStatus.isConfirmed ? 'alert-success' : 'alert-warning'"
        >
          {{ reservationStatus.message }}
        </div>

        <!-- Reservation form -->
        <div class="card p-3 mb-3">
          <h6>Napravi rezervaciju</h6>
          <form [formGroup]="reservationForm">
            <div class="mb-2">
              <input type="datetime-local" class="form-control" formControlName="startDate" />
            </div>
            <div class="mb-2">
              <input type="datetime-local" class="form-control" formControlName="endDate" />
            </div>
          </form>
          <button class="btn btn-primary w-100" (click)="createReservation()">Rezerviši</button>
        </div>

        <!-- Rating form -->
        <div class="card p-3">
          <h6>Ostavi ocenu</h6>
          <form [formGroup]="ratingForm">
            <div class="mb-2">
              <select class="form-select" formControlName="score">
                <option *ngFor="let s of [1, 2, 3, 4, 5]" [value]="s">{{ s }}</option>
              </select>
            </div>
            <div class="mb-2">
              <textarea rows="3" class="form-control" formControlName="comment"></textarea>
            </div>
          </form>
          <button class="btn btn-secondary w-100" (click)="createRating()">Oceni</button>
        </div>
      </div>
    </div>
  </div>
</div>
<div *ngIf="currentUser && ad?.ownerId === currentUser.id" class="owner-actions mt-3">
  <button class="btn btn-danger me-2" (click)="deleteAd()">Obriši oglas</button>
  <button class="btn btn-primary" (click)="toggleEdit()">Izmeni oglas</button>
</div>

<div *ngIf="isEditing" class="edit-form mt-3">
  <form [formGroup]="editForm" (ngSubmit)="updateAd()">
    <div class="mb-2">
      <label>Opis:</label>
      <textarea formControlName="description" class="form-control"></textarea>
    </div>

    <div class="form-check">
      <input type="checkbox" formControlName="garden" class="form-check-input" id="gardenCheck" />
      <label for="gardenCheck" class="form-check-label">Dvoriste</label>
    </div>

    <div class="form-check">
      <input
        type="checkbox"
        formControlName="parkingSpace"
        class="form-check-input"
        id="parkingCheck"
      />
      <label for="parkingCheck" class="form-check-label">Parking mesto</label>
    </div>

    <div class="form-check">
      <input
        type="checkbox"
        formControlName="swimmingPool"
        class="form-check-input"
        id="poolCheck"
      />
      <label for="poolCheck" class="form-check-label">Bazen</label>
    </div>

    <button class="btn btn-success mt-2" type="submit">Sačuvaj promene</button>
  </form>
</div>
